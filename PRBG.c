//
//  PRBG.c
//  P&D
//
//  Created by Augustin Moutarlier on 10/04/2019.
//  Copyright Â© 2019 Augustin MOUTARLIER. All rights reserved.
//

#include "PRBG.h"

/*
 uint16_t n = {0x0100, 0x7255, 0x416a, 0x7a93, 0x23e6, 0x1dcb, 0x350f, 0x82f4, 0x659a, 0x6e83, 0x28ac, 0x6803, 0xfdac, 0x547d, 0x3bc2, 0x2861, 0xffd, 0x2d58, 0x188d, 0xa5e9, 0x6e75, 0x64b5, 0x1339, 0xa9ec, 0xa37f, 0x6bbd, 0x2177, 0x5fde, 0xb4e1, 0x30fb, 0x927d, 0x46b9, 0x9e6f, 0xf5bb, 0x9da7, 0x6167, 0xa09f, 0x7729, 0xaa02, 0xf7e8, 0x456b, 0xb964, 0xf67c, 0x9da0, 0x60dd, 0xd0e6, 0x76ce, 0x909d, 0x3863, 0x884d, 0x2de, 0x17b3, 0xeae8, 0x4185, 0xa38a, 0x10da, 0x5a7, 0x38f7, 0x2443, 0xcc63, 0x9119, 0x8972, 0x4ecb, 0xc7f4, 0xddce, 0x8585, 0x876f, 0x25e9, 0xbc3, 0x318d, 0x5e7a, 0xa010, 0xf825, 0x68e8, 0xefc5, 0x6c4d, 0x2e09, 0xa825, 0x5f18, 0x7593, 0x7ce6, 0x9529, 0x75cb, 0x2ea6, 0x129f, 0x9fd2, 0x38a6, 0xb20b, 0x9dd, 0x3428, 0xbb8f, 0x45ea, 0xacfe, 0xb4b4, 0xdd38, 0x4e20, 0xd2ed, 0x9ba8, 0x71b, 0xff48, 0x2260, 0x45a3, 0x8fd2, 0x5fe6, 0x5f48, 0x5914, 0xc06a, 0xff2, 0xfcfb, 0xe440, 0xe247, 0xbbda, 0xf8fc, 0x26fd, 0x544, 0x4dd3, 0xca08, 0x96cb, 0x7ac4, 0xfb20, 0x288c, 0x5058, 0x2af3, 0x63c8, 0x6fd1, 0x563f, 0x4407, 0x253b, 0xd5e2, 0xe43e, 0xa2c, 0x9661, 0x2ebc, 0x29c1, 0x5852, 0xb57e, 0x2f22, 0x4d3d, 0xd68b, 0x4054, 0xac56, 0x15f1, 0xb6c7, 0xab1f, 0xdcd6, 0x1863, 0x529b, 0x9715, 0x26f4, 0x54de, 0x9cd1, 0xc137, 0xded8, 0xd90e, 0xbf47, 0xf2ab, 0x3cdf, 0x50da, 0x2c9e, 0x8180, 0x4c82, 0x7605, 0x3145, 0xb18c, 0xb86a, 0x6916, 0x161f, 0xac49, 0x8da, 0xe1f, 0xa59f, 0xbfae, 0x34a0, 0xf15d, 0x5601, 0x1773, 0x3381, 0x97a7, 0xa916, 0xf1f8, 0xc6fe, 0xc11c, 0x36b3, 0xa4fb, 0xd1ed, 0xd28b, 0xa7d2, 0x604c, 0xcaf1, 0x3ed0, 0x9f20, 0xdfe9, 0x95aa, 0xce46, 0x5820, 0x9a61, 0x708b, 0x59b3, 0xf56f, 0xdf12, 0x2020, 0xe6b5, 0x1ea8, 0x3c5a, 0xca94, 0x2f09, 0x3810, 0x808b, 0x32ed, 0x3524, 0x336e, 0x5230, 0x6c54, 0x95a8, 0xe4b1, 0x76d6, 0x7c0e, 0xdd4a, 0xe4f, 0xaa55, 0x8e6a, 0xd981, 0xebdc, 0x1cd4, 0xf4f1, 0xeae0, 0xb504, 0x413b, 0x25af, 0x7b25, 0x2d2f, 0x6280, 0x83c3, 0x2dc, 0xa09b, 0x814d, 0x7058, 0x4c85, 0x800e, 0x77a, 0xcbed, 0x1fe3, 0xf63b, 0xb064, 0xea6c, 0xb559, 0x5800, 0x804f, 0xfe9f, 0x6b64, 0x669b, 0xac1b, 0x919f, 0x883d, 0x9630, 0x4d, 0x7544};
 

void gcd ( int a, int b ){
    int c;
    while ( a != 0 ) {
        c = a; a = b%a;  b = c;
    }
}

void remove_leading_zeros(uint16_t *x) {
    uint16_t i;
    for (i = x[0]; x[i] == 0 && i > 0; i--)
        x[0]--;
}


void mp_square(uint16_t *x, uint16_t *w) {
    uint16_t i, j;
    uint32_t c;
    uint64_t uv = 0;
    uint16_t temp[MAX_SIZE] = {0};
    
    if (IS_NEGATIVE(x[x[0]])) {
        twos_complement(x, temp);
        mp_square(temp, w);
        return;
    }
    for (i = 0; i < 2 * x[0]; i++)
        w[i + 1] = 0;
    for (i = 0; i < x[0]; i++) {
        uv = (uint64_t) w[2 * i + 1] + (uint64_t) x[i + 1] * (uint64_t) x[i + 1];
        w[2 * i + 1] = (uint16_t) uv;
        c = (uint32_t) (uv >> 16);
        for (j = i + ONE; j < x[0]; j++) {
            uv = (uint64_t) w[i + j + 1] + (2 * (uint64_t) x[j + 1] * (uint64_t) x[i + 1]) + (uint64_t) c;
            w[i + j + 1] = (uint16_t) uv;
            c = (uint32_t) (uv >> 16);
        }
        w[i + x[0] + 1] = (uint16_t) (uv >> 16);
        if ((uv >> 32) > 0) {
            w[i + x[0] + 2] = (uint16_t) (uv >> 32);
        }
    }
    w[0] = (uint16_t) 2 * x[0];
    remove_leading_zeros(w);
}
 */
