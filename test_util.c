#include <stdint.h>
#include <stdio.h>
#include "util.h"

#define RUN_TEST(test, x, y) {if (is_equal(x,y) == TRUE) { printf(test); printf(" passed!\n"); } else { \
        printf(test); printf(" failed!\n"); printf("Expected: "); print_radix(y); printf("Got: "); print_radix(x);} }

uint16_t a[MAX_SIZE] = {0x8, 0x4867, 0x3767, 0x2d60, 0xa503, 0x7fe4, 0xa540, 0xc070, 0x67e7};
uint16_t b[MAX_SIZE] = {0x8, 0x78f9, 0x4952, 0x2293, 0xabbe, 0xb0c7, 0x2fb9, 0xe566, 0x4c4c};
/* e = gcd(a,b) */
uint16_t e[MAX_SIZE] = {0x1, 0x0001};
/* f = a^{-1} mod b */
uint16_t f[MAX_SIZE] = {0x8, 0x778c, 0x6c90, 0xa80c, 0xe431, 0x4674, 0x1b2c, 0x02a4, 0x3e99};
uint16_t m[MAX_SIZE] = {0x7, 0x78fa, 0xe4d2, 0x7165, 0x9ded, 0x9b72, 0x10f1, 0x1d56};
/* g = a / m  */
uint16_t g[MAX_SIZE] = {0x2, 0x8ab8, 0x0003};
/* h = a mod b */
uint16_t h[MAX_SIZE] = {0x8, 0xcf6e, 0xee14, 0xacc, 0xf945, 0xcf1c, 0x7586, 0xdb0a, 0x1b9a};
/* i = a * b */
uint16_t i[MAX_SIZE] = {0x10, 0xb42f, 0xdd63, 0xb06d, 0x0758, 0x5f64, 0x8fbe, 0x1be2, 0x03a2,
                        0x7400, 0x74d7, 0xb0f8, 0x81df, 0x9061, 0x5b5a, 0x030a, 0x1ef8};
/* j = a + b */
uint16_t j[MAX_SIZE] = {0x9, 0xc160, 0x80b9, 0x4ff3, 0x50c1, 0x30ac, 0xd4fa, 0xa5d6, 0xb434, 0x0000};
/* k = a - b */
uint16_t k[MAX_SIZE] = {0x8, 0xcf6e, 0xee14, 0x0acc, 0xf945, 0xcf1c, 0x7586, 0xdb0a, 0x1b9a};
uint16_t s = 0x2b73;
/* l = s * a */
uint16_t l[MAX_SIZE] = {0x9, 0xd345, 0x3c8e, 0x8b87, 0xa90c, 0xdb6d, 0x1174, 0x5e5c, 0x9a6e, 0x11a2};

uint16_t p[MAX_SIZE] = {0x8, 0xda84, 0xba01, 0xf583, 0xb33d, 0xd97a, 0x865f, 0x57b4, 0x16b8};
uint16_t q[MAX_SIZE] = {0x8, 0xcbfa, 0x5c6b, 0x8a92, 0xa8f9, 0xdf4c, 0x9055, 0xdef5, 0x213e};
uint16_t r[MAX_SIZE] = {0x8, 0xd639, 0xfe13, 0x6b1b, 0xb86c, 0xbd13, 0x1212, 0x7ca7, 0x43e3};
uint16_t R[MAX_SIZE] = {0x9, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001};
uint16_t R_square[MAX_SIZE] = {0x11, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001};
uint16_t r_prime[MAX_SIZE] = {0x1, 0xC7F7};
uint16_t base[MAX_SIZE] = {0x2, 0x0000, 0x0001};
uint16_t R_square_mod_r[MAX_SIZE] = {0x8, 0xe589, 0x4bda, 0xdad7, 0x4355, 0x3470, 0x7f65, 0x704d, 0x36d3};
uint16_t R_mod_r[MAX_SIZE] = {0x8, 0x7d55, 0x5c4, 0xbeac, 0xd6ba, 0xc8c4, 0xc9c7, 0x8a0a, 0x3455};
uint16_t p_square[MAX_SIZE] = {0x10, 0x1410, 0x3f8d, 0xfca3, 0x2c34, 0xb016, 0xee8a, 0x6fb, 0x2026, 0xa194, 0x52cb, 0x533, 0x1a54, 0xd5cc, 0x38a5, 0x33d1, 0x204};
uint16_t p_mod_q[MAX_SIZE] = {0x8, 0xda84, 0xba01, 0xf583, 0xb33d, 0xd97a, 0x865f, 0x57b4, 0x16b8};
uint16_t pq_mod_r[MAX_SIZE] = {0x8, 0x1008, 0x40d6, 0xbd4b, 0xf112, 0x91b5, 0xd9a3, 0x9163, 0x3cc1};
uint16_t p_pow_q_mod_r[MAX_SIZE] = {0x8, 0x7380, 0x18ea, 0x7918, 0x9e48, 0x925d, 0x9a0c, 0xe689, 0xd75};

uint16_t u[MAX_SIZE] = {0x1, 383};
uint16_t v[MAX_SIZE] = {0x1, 271};

uint16_t neg_one[MAX_SIZE] = {0x8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF};
uint16_t neg_two[MAX_SIZE] = {0x8, 0xFFFE, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF};
uint16_t max_neg[MAX_SIZE] = {0x8, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x8000};
uint16_t max_neg_plus[MAX_SIZE] = {0x8, 0x0001, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x8000};
uint16_t max_neg_twice[MAX_SIZE] = {0x9, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFFFF};
uint16_t max_neg_min[MAX_SIZE] = {0x9, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x7FFF, 0xFFFF};
uint16_t max_pos[MAX_SIZE] = {0x8, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x7FFF};
uint16_t zero[MAX_SIZE] = {0x8, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000};
uint16_t one[MAX_SIZE] = {0x8, 0x0001, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000};
uint16_t two[MAX_SIZE] = {0x8, 0x0002, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000};
uint16_t two_pow_12[MAX_SIZE] = {0x1, 0x1000};
uint16_t test_array[MAX_SIZE] = {0};
uint16_t test_array2[MAX_SIZE] = {0};
uint16_t test_array3[MAX_SIZE] = {0};

void test_addition() {
    mp_add(a, b, test_array);
    RUN_TEST("Addition test a + b", test_array, j);

    mp_add(neg_one, two, test_array);
    RUN_TEST("Addition test -1 + 2", test_array, one);

    mp_add(two, neg_one, test_array);
    RUN_TEST("Addition test 2 + -1", test_array, one);

    mp_add(zero, neg_one, test_array);
    RUN_TEST("Addition test 0 + -1", test_array, neg_one);

    mp_add(max_neg, neg_one, test_array);
    RUN_TEST("Addition test (max neg) + -1", test_array, max_neg_min);

    mp_add(neg_one, max_neg, test_array);
    RUN_TEST("Addition test -1 + (max neg)", test_array, max_neg_min);

    mp_add(max_neg_plus, neg_one, test_array);
    RUN_TEST("Addition test (max neg + 1) + -1", test_array, max_neg);

    mp_add(max_neg, max_neg, test_array);
    RUN_TEST("Addition test (max neg) + (max neg)", test_array, max_neg_twice);

    mp_add(neg_one, neg_one, test_array);
    RUN_TEST("Addition test -1 + -1", test_array, neg_two);

    mp_add(neg_one, one, test_array);
    RUN_TEST("Addition test -1 + 1", test_array, zero);
}

void test_subtraction() {
    mp_sub(zero, neg_one, test_array);
    RUN_TEST("Subtraction test 0 - -1", test_array, one);

    mp_sub(max_neg, neg_one, test_array);
    RUN_TEST("Subtraction test (max neg) - -1", test_array, max_neg_plus);

    mp_sub(max_neg, one, test_array);
    RUN_TEST("Subtraction test (max neg) - 1", test_array, max_neg_min);

    mp_sub(neg_one, max_neg, test_array);
    RUN_TEST("Subtraction test -1 - (max neg)", test_array, max_pos);

    mp_sub(max_neg_plus, one, test_array);
    RUN_TEST("Subtraction test (max neg + 1) - 1", test_array, max_neg);

    mp_sub(max_neg, max_neg, test_array);
    RUN_TEST("Subtraction test (max neg) - (max neg)", test_array, zero);

    mp_sub(neg_one, neg_one, test_array);
    RUN_TEST("Subtraction test -1 - -1", test_array, zero);

    mp_sub(neg_one, one, test_array);
    RUN_TEST("Subtraction test -1 - 1", test_array, neg_two);

    mp_sub(a, b, test_array);
    RUN_TEST("Subtraction test a - b", test_array, k);
}

void test_multiplication() {
    mp_mult(a, b, test_array);
    RUN_TEST("Multiplication test a * b", test_array, i);

    mp_mult_scalar(a, s, test_array);
    RUN_TEST("Multiplication test s * a", test_array, l);

    mp_square(p, test_array);
    RUN_TEST("p*p", test_array, p_square);
}

void test_division() {
    mp_div(a, m, test_array, test_array2);
    RUN_TEST("Division test a / m", test_array, g);

    mp_div(a, b, test_array, test_array2);
    RUN_TEST("Modulo test a mod b", test_array2, h);
}

void test_montgomery() {
    // Test montgomery exponentiation and multiplication
    mp_square(R, test_array);
    RUN_TEST("R*R", test_array, R_square);

    mp_div(R_square, r, test_array, test_array2);
    RUN_TEST("R*R mod r", test_array2, R_square_mod_r);

    mul_inv(r, base, test_array);
    twos_complement(test_array, test_array2);
    RUN_TEST("r prime", test_array2, r_prime);

    mont_mult(p, q, r, r_prime, test_array);
    mont_mult(R_square_mod_r, test_array, r, r_prime, test_array2);
    RUN_TEST("Montgomery multiplication pq mod r", test_array2, pq_mod_r);

    mont_exp(p, q, r, r_prime, R_mod_r, R, test_array);
    RUN_TEST("Montgomery exponentiation p^q mod r", test_array, p_pow_q_mod_r);
}

void test_dh_prime() {
    uint16_t x[MAX_SIZE] = {0x10, 0xf381, 0x605f, 0x123, 0x955e, 0xb1fb, 0x213b, 0x80b, 0xe3a7, 0x701c, 0x44b1, 0xf1b, 0xe436, 0x8ebf, 0x8dfc, 0x9eed, 0x7e88};
    uint16_t p4096[MAX_SIZE] = {0x100, 0xffff, 0xffff, 0xffff, 0xffff, 0x3199, 0x3406, 0x35c9, 0x4df4, 0xc08f, 0x90a6, 0xb7dc, 0x86ff, 0xddc1, 0x8d8f, 0xea98, 0x93b4, 0x5aa9, 0xd5b0, 0x9127, 0xd006, 0x481c, 0x2170, 0xdd76, 0xb81b, 0xd7af, 0xcee2, 0x2970, 0x1f61, 0xe7ed, 0x515b, 0xa186, 0x233b, 0xc3a2, 0xa090, 0x964f, 0x99b2, 0xc05d, 0x4e6b, 0x5947, 0x287c, 0xcaa6, 0x1fbe, 0xfc14, 0x2e8e, 0x8ef9, 0x4de, 0xc2db, 0xdbbb, 0x4ce8, 0x2ad4, 0xe9ca, 0x2583, 0xbda, 0xb615, 0x6834, 0x1a94, 0xe23c, 0x6af4, 0x2718, 0x99c3, 0x5b26, 0xbdba, 0x9a10, 0x8871, 0xe6d7, 0xa787, 0x3c12, 0x1a72, 0x801, 0xa921, 0xd120, 0x4b82, 0x108e, 0xe0fd, 0x5bfc, 0x43db, 0xab31, 0x74e5, 0x4fa0, 0x8e2, 0x46e2, 0xbad9, 0x88c0, 0x7709, 0x5d6c, 0x7a61, 0x1757, 0xbbe1, 0x200c, 0x177b, 0x2b18, 0x521f, 0x6a64, 0x3ec8, 0x273, 0xd876, 0x864, 0xd98a, 0xfa06, 0xf12f, 0xee6b, 0x1ad2, 0xd226, 0xcee3, 0x619d, 0x4a25, 0x94e0, 0x1e8c, 0x33d7, 0xdb09, 0xae8c, 0xabf5, 0xe4c7, 0xa6e1, 0xf85, 0xb397, 0xc7d, 0x5d06, 0x7157, 0x8aea, 0xef0a, 0x58db, 0x8504, 0xecfb, 0xba64, 0xdf1c, 0x21ab, 0xa855, 0x7a33, 0x450, 0x170d, 0xad33, 0xc42d, 0x8aaa, 0x8e5a, 0x1572, 0x510, 0x98fa, 0x2618, 0x15d2, 0x6ae5, 0xea95, 0x497c, 0x3995, 0x1718, 0x9558, 0xcbf6, 0xde2b, 0x52c9, 0x6f4c, 0x5df0, 0xb5c5, 0xa28f, 0xec07, 0x83a2, 0x9b27, 0x8603, 0x180e, 0x772c, 0xe39e, 0xce3b, 0x2e36, 0x5e46, 0x3290, 0x217c, 0xca18, 0x6c08, 0xf174, 0x9804, 0x4abc, 0x354e, 0x670c, 0x966d, 0x7096, 0x2907, 0x9ed5, 0x52bb, 0x2085, 0xf356, 0x1c62, 0xad96, 0xdca3, 0x5d23, 0x8365, 0xcf5f, 0xfd24, 0x3fa8, 0x6916, 0xd39a, 0x1c55, 0x4836, 0x98da, 0xbf05, 0xa163, 0x7cb8, 0xc200, 0x5b3d, 0xece4, 0x6651, 0x4928, 0x1fe6, 0x7c4b, 0x2411, 0xae9f, 0x9fa5, 0x5a89, 0x6bfb, 0xee38, 0xb7ed, 0xf406, 0x5cb6, 0xbff, 0xed6b, 0xa637, 0x42e9, 0xf44c, 0x7ec6, 0x625e, 0xb576, 0xe485, 0xc245, 0x6d51, 0x356d, 0x4fe1, 0x1437, 0xf25f, 0xa6d, 0x302b, 0x431b, 0xcd3a, 0x19b3, 0xef95, 0x4dd, 0x8e34, 0x879, 0x514a, 0x9b22, 0x3b13, 0xbea6, 0x20b, 0xcc74, 0x8a67, 0x4e08, 0x2902, 0x1cd1, 0x80dc, 0x628b, 0xc4c6, 0xc234, 0x2168, 0xdaa2, 0xc90f, 0xffff, 0xffff, 0xffff, 0xffff};
    uint16_t p4096_g[MAX_SIZE] = {0x1, 0x0002};
    uint16_t p4096_prime[MAX_SIZE] = {0x100, 0x1, 0x0, 0x0, 0x0, 0x319a, 0x3406, 0x35c9, 0x4df4, 0x1133, 0x7d7b, 0xe3fd, 0x565, 0x1c8, 0x75be, 0x4883, 0xe544, 0x1843, 0x8ae8, 0x3cab, 0xd084, 0x3027, 0xce44, 0xe0, 0x196c, 0x8f1a, 0xd7c2, 0x793c, 0x7832, 0x5044, 0xc49f, 0xf2fe, 0xcb41, 0x16a4, 0x40d0, 0xdf81, 0x17e4, 0x8506, 0x5ddb, 0x116c, 0x4dbf, 0xfd3d, 0x5fcf, 0x5c9c, 0x92be, 0x8b42, 0x215f, 0x9a9, 0x483e, 0x814e, 0xfdd8, 0xfa88, 0xc363, 0xb4f1, 0x87a5, 0x6ee1, 0xe494, 0x2a90, 0x9d2d, 0xcf2a, 0x54cf, 0x8f85, 0x22fc, 0xbf34, 0xd4e7, 0x1d7e, 0xb2bb, 0x2fe2, 0x3183, 0xf4a6, 0x265c, 0xdcee, 0x9946, 0x699d, 0xe291, 0x4071, 0xabc9, 0xfd2d, 0x8d53, 0xd765, 0xee24, 0x21c3, 0xf956, 0x90e2, 0xc666, 0x21, 0x4583, 0x47b7, 0xd095, 0x54da, 0x93a2, 0x122f, 0x7814, 0xdab3, 0x9a81, 0x3797, 0xe756, 0x401, 0x8eb7, 0x6d05, 0x48f5, 0xe653, 0x21d1, 0xe1e2, 0xdfc6, 0x7024, 0xcd75, 0xe5c8, 0xdb9d, 0xd394, 0x8754, 0x23, 0x5de8, 0xf692, 0x5b73, 0x827a, 0x3a75, 0x133b, 0x47e4, 0xed5a, 0xfd74, 0x2b99, 0xbaa9, 0x53bc, 0x936d, 0x12f5, 0xbf0b, 0x80ab, 0x4f23, 0xe7e5, 0xbdc8, 0xab3e, 0xdbfe, 0x267, 0xf783, 0x710, 0x1452, 0xa31a, 0xd12b, 0x2d6e, 0x25be, 0xb97a, 0xe07c, 0x2357, 0xb390, 0x5f23, 0x1e04, 0xb18b, 0x6511, 0xece4, 0xd5de, 0x541, 0x3900, 0x6b47, 0x28c3, 0xdfcf, 0x8afa, 0x40bb, 0x27cc, 0xcaaf, 0x8c1e, 0x2a04, 0x9337, 0xe76b, 0x7d34, 0xa561, 0x274a, 0x62cd, 0x91c1, 0x121c, 0x5eb, 0xab68, 0x9711, 0x74df, 0xfef3, 0xd19b, 0x999a, 0x8482, 0x906, 0xa808, 0x9a45, 0x8fb, 0x5e4b, 0xbb4, 0x7416, 0x259c, 0xc58b, 0xd25e, 0x719, 0x59e0, 0x16aa, 0x458e, 0x254f, 0x7062, 0xc0fa, 0xdd96, 0x2c13, 0xcffd, 0x3fe5, 0x8ee9, 0x3722, 0x90a2, 0xed68, 0x3, 0xf809, 0x3cd5, 0x5a9a, 0xf806, 0x92e9, 0x3d22, 0xd8de, 0x53b5, 0xbce3, 0x8d6e, 0xb6da, 0x8cfc, 0x40de, 0x798c, 0x3c33, 0xe554, 0x8fb6, 0xac0a, 0x7b18, 0xced0, 0x4b7a, 0xc4be, 0x7c84, 0x7ff7, 0xb8e5, 0xfad5, 0x2ea8, 0x59dc, 0xb1f3, 0xee89, 0x4a34, 0xfef7, 0x3001, 0xbeb6, 0x4b65, 0xf24d, 0xc991, 0xe103, 0xfaac, 0xadef, 0xb6c2, 0x9a15, 0x20e1, 0xbb03, 0xa158, 0xf860, 0xfe5e, 0xbdb6, 0x9837, 0x217f, 0x23ee, 0xfbcc, 0x17cd};
    uint16_t R[MAX_SIZE] = {0x101, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1};
    uint16_t R_mod_p[MAX_SIZE] = {0xfc, 0x1, 0x0, 0x0, 0x0, 0xce66, 0xcbf9, 0xca36, 0xb20b, 0x3f70, 0x6f59, 0x4823, 0x7900, 0x223e, 0x7270, 0x1567, 0x6c4b, 0xa556, 0x2a4f, 0x6ed8, 0x2ff9, 0xb7e3, 0xde8f, 0x2289, 0x47e4, 0x2850, 0x311d, 0xd68f, 0xe09e, 0x1812, 0xaea4, 0x5e79, 0xdcc4, 0x3c5d, 0x5f6f, 0x69b0, 0x664d, 0x3fa2, 0xb194, 0xa6b8, 0xd783, 0x3559, 0xe041, 0x3eb, 0xd171, 0x7106, 0xfb21, 0x3d24, 0x2444, 0xb317, 0xd52b, 0x1635, 0xda7c, 0xf425, 0x49ea, 0x97cb, 0xe56b, 0x1dc3, 0x950b, 0xd8e7, 0x663c, 0xa4d9, 0x4245, 0x65ef, 0x778e, 0x1928, 0x5878, 0xc3ed, 0xe58d, 0xf7fe, 0x56de, 0x2edf, 0xb47d, 0xef71, 0x1f02, 0xa403, 0xbc24, 0x54ce, 0x8b1a, 0xb05f, 0xf71d, 0xb91d, 0x4526, 0x773f, 0x88f6, 0xa293, 0x859e, 0xe8a8, 0x441e, 0xdff3, 0xe884, 0xd4e7, 0xade0, 0x959b, 0xc137, 0xfd8c, 0x2789, 0xf79b, 0x2675, 0x5f9, 0xed0, 0x1194, 0xe52d, 0x2dd9, 0x311c, 0x9e62, 0xb5da, 0x6b1f, 0xe173, 0xcc28, 0x24f6, 0x5173, 0x540a, 0x1b38, 0x591e, 0xf07a, 0x4c68, 0xf382, 0xa2f9, 0x8ea8, 0x7515, 0x10f5, 0xa724, 0x7afb, 0x1304, 0x459b, 0x20e3, 0xde54, 0x57aa, 0x85cc, 0xfbaf, 0xe8f2, 0x52cc, 0x3bd2, 0x7555, 0x71a5, 0xea8d, 0xfaef, 0x6705, 0xd9e7, 0xea2d, 0x951a, 0x156a, 0xb683, 0xc66a, 0xe8e7, 0x6aa7, 0x3409, 0x21d4, 0xad36, 0x90b3, 0xa20f, 0x4a3a, 0x5d70, 0x13f8, 0x7c5d, 0x64d8, 0x79fc, 0xe7f1, 0x88d3, 0x1c61, 0x31c4, 0xd1c9, 0xa1b9, 0xcd6f, 0xde83, 0x35e7, 0x93f7, 0xe8b, 0x67fb, 0xb543, 0xcab1, 0x98f3, 0x6992, 0x8f69, 0xd6f8, 0x612a, 0xad44, 0xdf7a, 0xca9, 0xe39d, 0x5269, 0x235c, 0xa2dc, 0x7c9a, 0x30a0, 0x2db, 0xc057, 0x96e9, 0x2c65, 0xe3aa, 0xb7c9, 0x6725, 0x40fa, 0x5e9c, 0x8347, 0x3dff, 0xa4c2, 0x131b, 0x99ae, 0xb6d7, 0xe019, 0x83b4, 0xdbee, 0x5160, 0x605a, 0xa576, 0x9404, 0x11c7, 0x4812, 0xbf9, 0xa349, 0xf400, 0x1294, 0x59c8, 0xbd16, 0xbb3, 0x8139, 0x9da1, 0x4a89, 0x1b7a, 0x3dba, 0x92ae, 0xca92, 0xb01e, 0xebc8, 0xda0, 0xf592, 0xcfd4, 0xbce4, 0x32c5, 0xe64c, 0x106a, 0xfb22, 0x71cb, 0xf786, 0xaeb5, 0x64dd, 0xc4ec, 0x4159, 0xfdf4, 0x338b, 0x7598, 0xb1f7, 0xd6fd, 0xe32e, 0x7f23, 0x9d74, 0x3b39, 0x3dcb, 0xde97, 0x255d, 0x36f0};
    uint16_t result[MAX_SIZE] = {0x100, 0x34e0, 0xe441, 0x78b1, 0x9dc0, 0x2a23, 0xf511, 0xe63b, 0x48c2, 0x501e, 0x4271, 0x105e, 0xe183, 0xbb27, 0x313b, 0x9448, 0xfdb7, 0xe931, 0xe7c0, 0xd250, 0xd1ee, 0x9e73, 0x3915, 0xa3d9, 0xcf97, 0x9cf4, 0x6b04, 0x4de0, 0x7605, 0xc8e, 0xab72, 0x409a, 0x16be, 0xf92c, 0xfc3, 0xe865, 0x6759, 0xab12, 0xfdad, 0x311c, 0x27a1, 0x47f3, 0x76be, 0xa19c, 0xbbb9, 0x27f4, 0x49ba, 0x7441, 0x63ca, 0x12cd, 0xf69f, 0x7d3e, 0x51f4, 0x2424, 0x3ae6, 0x6e99, 0xa11b, 0x597e, 0xb0b3, 0x79ce, 0xf2ae, 0x1166, 0xb548, 0x9ab, 0x26a4, 0x63f3, 0x3366, 0x6fd7, 0x5945, 0x8321, 0x8e7d, 0xa3b3, 0x8347, 0x18a0, 0xfd92, 0x1a9f, 0x214e, 0x4ff, 0x5e86, 0x8794, 0xaff2, 0x1957, 0x99a2, 0xde18, 0x23c9, 0xfdca, 0x75a2, 0x100, 0xcee7, 0xb031, 0x5eea, 0xa652, 0x1e0f, 0x9679, 0x1428, 0x8e89, 0x46c6, 0x5361, 0x8223, 0x7b62, 0x392d, 0x7a9, 0x72d, 0xffa7, 0x154, 0x3a77, 0xd14d, 0xc9fb, 0xb5ef, 0x728a, 0xba37, 0x6385, 0xe26d, 0xf194, 0xaf06, 0xbb2b, 0x4236, 0x5537, 0x80d5, 0xac21, 0xd407, 0xf490, 0x24a2, 0x35cb, 0xd4dd, 0x3a2d, 0xd2be, 0xc287, 0xd051, 0xdae6, 0x7353, 0xb943, 0xe2b7, 0x5a4e, 0xbe01, 0xa979, 0x1b9e, 0xf278, 0x810, 0x5480, 0x7ca, 0x9e90, 0xfdd6, 0x4023, 0xd575, 0x7194, 0x5296, 0x1d21, 0xd352, 0xa1a6, 0x2f96, 0xa9b2, 0xa5b3, 0x2fa, 0xfa6e, 0x2b61, 0x1968, 0x5ac, 0xf12d, 0xadb6, 0x7bb0, 0x41bc, 0xce27, 0xb1c, 0xe8e1, 0x19a2, 0x8142, 0xd1db, 0xb954, 0xddd4, 0x50c4, 0xff3a, 0xe142, 0xbc3c, 0x2cba, 0x5170, 0xdfdc, 0x6f6a, 0x1c41, 0xdc9a, 0x64e4, 0x3ffa, 0xf785, 0x643a, 0x3cca, 0xb064, 0xf0f1, 0x6b32, 0xef66, 0xeb3c, 0xa79c, 0x6347, 0x9b36, 0xfb43, 0x2de5, 0x2a70, 0xd7bf, 0xe816, 0x3a40, 0xa4fe, 0x513f, 0x3979, 0xf507, 0xf291, 0x9b9c, 0xb149, 0xfdd3, 0xc263, 0x1b3f, 0x574c, 0x8540, 0x9af1, 0xf721, 0x6e2c, 0x39ce, 0xbf19, 0xe252, 0x4be5, 0x53b9, 0x220, 0xe5ae, 0xd4b2, 0xcd97, 0xcc1, 0xfdb0, 0x97e9, 0xc847, 0x4836, 0xe8ad, 0x4127, 0xc779, 0xed31, 0xc98e, 0x29e5, 0xcf7, 0x2849, 0xaa39, 0x15ee, 0x3311, 0x8233, 0xfabe, 0xc04d, 0x991e, 0x77b5, 0x6b7c, 0xb18a, 0x4dc4, 0x763d, 0x8740, 0xa2ab, 0xdd1, 0xd633, 0xc668, 0xac51, 0x768f, 0x4456, 0x7a6f};
    dh_mon_exp(p4096_g, x, p4096, p4096_prime, R, test_array);
    RUN_TEST("DH prime test", test_array, result);
}

int main(void) {
    test_dh_prime();
//    test_addition();
//    test_subtraction();
//    test_multiplication();
//    test_division();
//
//    binary_extended_gcd(b, a, test_array, test_array2, test_array3);
//    RUN_TEST("GCD test: gcd(a,b)", test_array3, e);
//
//    mul_inv(a, b, test_array);
//    RUN_TEST("Modular inverse a^{-1} mod b", test_array, f);
//
//    mp_div(R, q, test_array2, test_array3);
//    barret_reduction(p, q, test_array2, test_array);
//    RUN_TEST("p mod q (barret reduction)", test_array, p_mod_q);
//
//    test_montgomery();
    return 0;
}